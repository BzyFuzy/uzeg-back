{"version":3,"sources":["views/journalist/workspace/index.js","containers/Card.js"],"names":["API_URL","window","location","origin","toString","WorkSpace","useState","body","title","content","setContent","style","padding","fontSize","color","marginBottom","TextEditor","onSubmit","data","marginTop","className","dangerouslySetInnerHTML","__html","iniState","category","formData","setFormData","setBody","e","preventDefault","token","localStorage","getItem","axios","post","headers","Authorization","then","status","alert","display","flexDirection","type","placeholder","name","value","onChange","target","editor","ClassicEditor","config","extraPlugins","plugins","get","createUploadAdapter","loader","upload","Promise","resolve","reject","FormData","file","append","fetch","method","res","json","default","filename","catch","err","uploadAdapter","event","getData","cursor","alignSelf","background","border","borderRadius","Row","props","children","Card"],"mappings":"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","file":"static/js/7.8c22afb8.chunk.js","sourcesContent":["import React, { useState } from \"react\";\r\nimport Card from \"../../../containers/Card\";\r\nimport { CKEditor } from \"@ckeditor/ckeditor5-react\";\r\nimport ClassicEditor from \"@ckeditor/ckeditor5-build-classic\";\r\nimport axios from \"axios\";\r\n\r\nconst API_URL = window.location.origin.toString();\r\nconst UPLOAD_ENDPOINT = \"api/photos/upload\";\r\nexport default function WorkSpace() {\r\n  const [content, setContent] = useState({body: \"\", title: \"\"});\r\n  return (\r\n    <div>\r\n      <Card\r\n        style={{\r\n          padding: \"32.5px 42px\",\r\n        }}\r\n      >\r\n        <p\r\n          style={{\r\n            fontSize: \"18px\",\r\n            color: \"#212543\",\r\n            marginBottom: 20,\r\n          }}\r\n        >\r\n          Мэдээ нэмэх\r\n        </p>\r\n        <TextEditor onSubmit={(data) => setContent(data)} />\r\n      </Card>\r\n\r\n      <Card style={{ marginTop: 10, padding: \"32.5px 42px\" }}>\r\n        <h1>{content.title}</h1>\r\n        <div\r\n          className=\"ck-content\"\r\n          dangerouslySetInnerHTML={{ __html: content.body }}\r\n        ></div>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\nconst iniState = {\r\n  title: \"\",\r\n  category: \"\",\r\n};\r\nconst TextEditor = ({ onSubmit }) => {\r\n  const [formData, setFormData] = useState(iniState);\r\n  const [body, setBody] = useState(\"\");\r\n\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault();\r\n    const token = localStorage.getItem(\"access\");\r\n    axios\r\n      .post(\r\n        \"/api/news/\",\r\n        { ...formData, body },\r\n        {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        }\r\n      )\r\n      .then(({ data }) => {\r\n        if (data.status === \"amjilttai\") {\r\n          onSubmit({ ...formData, body });\r\n          setFormData(iniState);\r\n          setBody(\"\");\r\n          alert(\"Amjilttai niitlegdlee\");\r\n        } else {\r\n          alert(\"Please check internet connection\");\r\n        }\r\n      });\r\n  };\r\n\r\n  function uploadAdapter(loader) {\r\n    return {\r\n      upload: () => {\r\n        return new Promise((resolve, reject) => {\r\n          const body = new FormData();\r\n          loader.file.then((file) => {\r\n            body.append(\"file\", file);\r\n            // let headers = new Headers();\r\n            // headers.append(\"Origin\", \"http://localhost:3000\");\r\n            fetch(`${API_URL}/${UPLOAD_ENDPOINT}`, {\r\n              method: \"post\",\r\n              body: body,\r\n              // mode: \"no-cors\"\r\n            })\r\n              .then((res) => res.json())\r\n              .then((res) => {\r\n                resolve({\r\n                  default: `http://localhost:3001/news/image/${res.filename}`,\r\n                });\r\n              })\r\n              .catch((err) => {\r\n                reject(err);\r\n              });\r\n          });\r\n        });\r\n      },\r\n    };\r\n  }\r\n  function uploadPlugin(editor) {\r\n    editor.plugins.get(\"FileRepository\").createUploadAdapter = (loader) => {\r\n      return uploadAdapter(loader);\r\n    };\r\n  }\r\n\r\n  return (\r\n    <form\r\n      onSubmit={handleSubmit}\r\n      style={{ display: \"flex\", flexDirection: \"column\" }}\r\n    >\r\n      <input\r\n        style={{ marginBottom: \"10px\", padding: \"10px 5px\" }}\r\n        type=\"text\"\r\n        placeholder=\"Гарчиг\"\r\n        name=\"title\"\r\n        value={formData.title}\r\n        onChange={(e) => setFormData({ ...formData, title: e.target.value })}\r\n      />\r\n      <input\r\n        style={{ marginBottom: \"10px\", padding: \"10px 5px\" }}\r\n        type=\"text\"\r\n        placeholder=\"Категори\"\r\n        name=\"category\"\r\n        value={formData.category}\r\n        onChange={({ target }) =>\r\n          setFormData({ ...formData, category: target.value })\r\n        }\r\n      />\r\n      <CKEditor\r\n        editor={ClassicEditor}\r\n        data={body}\r\n        config={{\r\n          extraPlugins: [uploadPlugin],\r\n        }}\r\n        onChange={(event, editor) => {\r\n          const data = editor.getData();\r\n          setBody(data);\r\n        }}\r\n      />\r\n      <button\r\n        style={{\r\n          cursor: \"pointer\",\r\n          alignSelf: \"flex-end\",\r\n          marginTop: 20,\r\n          background: \"#d4938b\",\r\n          color: \"#FFF\",\r\n          border: \"none\",\r\n          padding: \"5px 20px\",\r\n          borderRadius: 5,\r\n        }}\r\n        type=\"submit\"\r\n      >\r\n        Нийтлэх\r\n      </button>\r\n    </form>\r\n  );\r\n};\r\n","const Card = (props) => {\r\n  return (\r\n    <div className=\"card\" {...props}>\r\n      {props.children}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const Row = (props) => {\r\n  return <div {...props}>{props.children}</div>;\r\n};\r\n\r\nexport default Card;\r\n"],"sourceRoot":""}